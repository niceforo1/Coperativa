<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<ui:composition template="/WEB-INF/template/abms/ABMTemplate.xhtml">
	<ui:define name="tituloPantalla">
		<h:outputFormat value="#{msg.title}">
			<f:param value="#{msg.titleSocio}" />
		</h:outputFormat>
	</ui:define>
	<ui:define name="content">
		<center>
			<h:form id="alta">
				<p:messages id="mensajes" showDetail="true" autoUpdate="true"
					closable="true" />
				<p:panel header="#{msg.paramPeriodoFacturacionHeader}">
					<p:panelGrid columns="2">
						<p:outputLabel for="mes" value="Mes:" />
						<p:selectOneMenu id="mes"
							value="#{periodoFacturacionBean.periodoFacturacion.mes}"
							panelStyle="width:180px" effect="fold" filter="true"
							required="true" disabled="#{periodoFacturacionBean.periodoAbiertoCons()}">
							<f:selectItem itemLabel="#{msg.paramCombos}" itemValue="" />
							<f:selectItem itemLabel="ENERO" itemValue="1" />
							<f:selectItem itemLabel="FEBRERO" itemValue="2" />
							<f:selectItem itemLabel="MARZO" itemValue="3" />
							<f:selectItem itemLabel="ABRIL" itemValue="4" />
							<f:selectItem itemLabel="MAYO" itemValue="5" />
							<f:selectItem itemLabel="JUNIO" itemValue="6" />
							<f:selectItem itemLabel="JULIO" itemValue="7" />
							<f:selectItem itemLabel="AGOSTO" itemValue="8" />
							<f:selectItem itemLabel="SEPTIEMBRE" itemValue="9" />
							<f:selectItem itemLabel="OCTUBRE" itemValue="10" />
							<f:selectItem itemLabel="NOVIEMBRE" itemValue="11" />
							<f:selectItem itemLabel="DICIEMBRE" itemValue="12" />
						</p:selectOneMenu>
						<p:outputLabel for="mes" value="Año:" />
						<p:selectOneMenu id="anio"
							value="#{periodoFacturacionBean.periodoFacturacion.anio}"
							panelStyle="width:180px" effect="fold" filter="true"
							required="true" disabled="#{periodoFacturacionBean.periodoAbiertoCons()}"> 
							<f:selectItem itemLabel="#{msg.paramCombos}" itemValue="" />
							<f:selectItem itemLabel="2010" itemValue="2010" />
							<f:selectItem itemLabel="2011" itemValue="2011" />
							<f:selectItem itemLabel="2012" itemValue="2012" />
							<f:selectItem itemLabel="2013" itemValue="2013" />
							<f:selectItem itemLabel="2014" itemValue="2014" />
							<f:selectItem itemLabel="2015" itemValue="2015" />
							<f:selectItem itemLabel="2016" itemValue="2016" />
							<f:selectItem itemLabel="2017" itemValue="2017" />
							<f:selectItem itemLabel="2018" itemValue="2018" />
							<f:selectItem itemLabel="2019" itemValue="2019" />
							<f:selectItem itemLabel="2020" itemValue="2020" />
							<f:selectItem itemLabel="2021" itemValue="2021" />
							<f:selectItem itemLabel="2022" itemValue="2022" />
							<f:selectItem itemLabel="2023" itemValue="2023" />
							<f:selectItem itemLabel="2024" itemValue="2024" />
							<f:selectItem itemLabel="2025" itemValue="2025" />
							<f:selectItem itemLabel="2026" itemValue="2026" />
							<f:selectItem itemLabel="2027" itemValue="2027" />
							<f:selectItem itemLabel="2028" itemValue="2028" />
							<f:selectItem itemLabel="2029" itemValue="2029" />
							<f:selectItem itemLabel="2030" itemValue="2030" />
						</p:selectOneMenu>
						<p:outputLabel value="#{msg.paramPeriodoFacturacionCESP}" for="cesp" />
						<p:inputText id="cesp"
							value="#{periodoFacturacionBean.periodoFacturacion.cesp}" required="true" />
						<p:outputLabel value="#{msg.paramPeriodoFacturacionVtoCESP}"
							for="vtoCesp" />
						<p:calendar id="vtoCesp"
							value="#{periodoFacturacionBean.periodoFacturacion.fechaVtoCesp}"
							effect="explode" required="true" locale="es" navigator="true" />
						<p:outputLabel
							value="#{msg.paramPeriodoFacturacionFechaEmisionFactura}"
							for="fechaEmFact" />
						<p:calendar id="fechaEmFact"
							value="#{periodoFacturacionBean.periodoFacturacion.fechaEmisionFactura}"
							effect="explode" required="true" locale="es" navigator="true" />
						<p:outputLabel
							value="#{msg.paramPeriodoFacturacionFechaPrimerVencimientoFact}"
							for="primerVencFact" />
						<p:calendar id="primerVencFact"
							value="#{periodoFacturacionBean.periodoFacturacion.fechaPrimerVencimientoFactura}"
							effect="explode" required="true" locale="es" navigator="true" />
						<p:outputLabel
							value="#{msg.paramPeriodoFacturacionFechaSegundoVencimientoFact}"
							for="segundoVencFact" />
						<p:calendar id="segundoVencFact"
							value="#{periodoFacturacionBean.periodoFacturacion.fechaSegundoVencimientoFactura}"
							effect="explode" required="true" locale="es" navigator="true" />
						<f:facet name="footer">
							<center>
								<p:commandButton
									actionListener="#{periodoFacturacionBean.insertarPeriodoFacturacion}"
									update=":alta :mostrar" value="#{msg.paramCargar}" disabled="#{periodoFacturacionBean.periodoAbiertoCons()}" /> 
							</center>
						</f:facet>
					</p:panelGrid>
				</p:panel>
			</h:form>

			<br />

			<h:form id="mostrar">
				<p:dataTable id="periodosFactDT" var="perFact"
					value="#{periodoFacturacionBean.lstPeriodoFacturacion}" scrollable="true"
					scrollHeight="150" rowKey="#{perLect.id}"
					emptyMessage="#{msg.paramNoDatos}">
					<f:facet name="header">
						<center>
							<p:outputLabel value="#{msg.paramPeriodoFacturacionTable}" />
						</center>
					</f:facet>
					<p:column headerText="Id" filterBy="#{perFact.id}"
						filterMatchMode="contains">
						<p:outputLabel value="#{perFact.id}" />
					</p:column>
					<p:column style="width:110px" headerText="Año" filterBy="#{perFact.anio}"
						filterMatchMode="contains">
						<p:outputLabel value="#{perFact.anio}" />
					</p:column>
					<p:column style="width:110px" headerText="Mes" filterBy="#{perFact.mes}"
						filterMatchMode="contains">
						<p:outputLabel value="#{perFact.mes}" />
					</p:column>
					<p:column headerText="#{msg.paramPeriodoFacturacionCESP}"
						filterBy="#{perFact.cesp}" filterMatchMode="contains">
						<p:outputLabel value="#{perFact.cesp}" />
					</p:column>
					<ui:remove>
					<p:column style="width:100px" headerText="#{msg.paramPeriodoFacturacionVtoCESP}"
						filterBy="#{perFact.fechaVtoCesp}" filterMatchMode="contains">
						<p:outputLabel
							value="#{loginBean.formatearFechaMes(perFact.fechaVtoCesp, 'dd/MM/yyyy')}" />
					</p:column>
					</ui:remove>
					<p:column
						headerText="#{msg.paramPeriodoFacturacionFechaEmisionFactura}"
						filterBy="#{perFact.fechaEmisionFactura}"
						filterMatchMode="contains">
						<p:outputLabel
							value="#{loginBean.formatearFechaMes(perFact.fechaEmisionFactura, 'dd/MM/yyyy')}" />
					</p:column>
					<p:column headerText="1er Vencimiento Fact"
						filterBy="#{perFact.fechaPrimerVencimientoFactura}"
						filterMatchMode="contains">
						<p:outputLabel
							value="#{loginBean.formatearFechaMes(perFact.fechaPrimerVencimientoFactura, 'dd/MM/yyyy')}" />
					</p:column>
					<p:column headerText="2do Vencimiento Fact"
						filterBy="#{perFact.fechaSegundoVencimientoFactura}"
						filterMatchMode="contains">
						<p:outputLabel
							value="#{loginBean.formatearFechaMes(perFact.fechaSegundoVencimientoFactura, 'dd/MM/yyyy')}" />
					</p:column>
					<p:column headerText="#{msg.paramPeriodoFacturacionEstado}"
						filterBy="#{perFact.estadoPeriodo.descripcion}"
						filterMatchMode="contains">
						<p:outputLabel value="#{perFact.estadoPeriodo.descripcion}" />
					</p:column>
					<p:column style="width:110px;text-align: center" exportable="false"
						rendered="#{perFact.estadoPeriodo.descripcion == 'EN PROCESO'}">
						<p:commandButton value="CERRAR PERIODO"
							actionListener="#{periodoFacturacionBean.cambiarEstadoPeriodo('CERRADO', perFact)}"
							update=":alta :mostrar" immediate="true" />
					</p:column>
					<p:column style="width:110px;text-align: center" exportable="false"
						rendered="#{perFact.estadoPeriodo.descripcion == 'CERRADO'}">
						<p:commandButton value="FACTURADO"
							actionListener="#{periodoFacturacionBean.cambiarEstadoPeriodo('FACTURADO', perFact)}"
							update=":alta :mostrar" immediate="true" />
					</p:column>
					<f:facet name="footer">
						<p:outputLabel value=" " />
					</f:facet>
				</p:dataTable>
			</h:form>
		</center>
	</ui:define>
</ui:composition>
</html>